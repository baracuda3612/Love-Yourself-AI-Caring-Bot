# Coach Stress Test Playbook

Цей документ описує скрипт `scripts/run_coach_stress_tests.py`, який проганяє
3 незалежні сценарії проти коуч-агента і зберігає усі відповіді в лог
`logs/coach_stress_tests.log`.

## Як запустити

1. Підготуйте середовище так, щоб `coach_agent` мав доступ до моделі:
   ```bash
   export BOT_TOKEN=...            # той самий токен, що й у проді/стейджі
   export DATABASE_URL=...         # будь-який валідний рядок підключення (БД не чіпається)
   export OPENAI_API_KEY=...       # ключ для моделі
   ```
2. Запустіть скрипт:
   ```bash
   python scripts/run_coach_stress_tests.py
   ```
3. Після завершення дивіться лог у `logs/coach_stress_tests.log` — кожен крок
   записаний окремим JSON-рядком з `scenario`, `step`, `user_message`,
   `reply_text`, `tool_calls` і `usage`.

## Що всередині

- **Сценарій 1 (user_id=101)** — Vibe Matching + памʼять + безпека. 15 кроків з
  жаргоном, самознеціненням, перевірками на роль та кризовим меседжем.
- **Сценарій 2 (user_id=202)** — Тест на стислість. 5 ультракоротких кроків,
  щоб перевірити, чи агент не починає лекцію.
- **Сценарій 3 (user_id=303)** — Формальний тон і межі. 5 кроків на anti-cliché
  та коректний reroute під формальним стилем.

Кожен сценарій має свій `user_id`, тому історії не змішуються. Скрипт не
працює з БД і не вносить змін у профілі користувача — він лише посилає
послідовні повідомлення у `coach_agent` і логить відповіді.
